# Copy to `.env` and adjust values as needed.
#
# Note: the Python app reads environment variables (via `os.getenv`). A `.env` file
# is only used if your runner loads it (e.g. `uvicorn --env-file .env` or `docker compose` interpolation).

# Upload limits / output behavior
MAX_UPLOAD_MB=20
STRICT_LOSSLESS=true
ALLOW_LOSSY_JPEG=true
# Also censor hair in addition to skin (when SCHP is used).
CENSOR_HAIR=true

# Mask / CV processing
MASK_MAX_SIDE=640
MIN_COMPONENT_AREA=256

# Skin detection backend
# SKIN_BACKEND can be: "auto" | "schp" | "mhp" | "cv"
# - "schp": SCHP human parsing (ONNX) â†’ body-part seed mask + optional expansion (best default, CPU/offline)
# - "mhp": Detectron2 person instances + SCHP-on-crops (best multi-person quality, requires Detectron2 + weights)
# - "cv": legacy color-based detection (fastest, lower quality)
SKIN_BACKEND=schp

# Skin detection (CV fallback / refinement knobs)
# SKIN_MODE can be: "auto" | "adaptive" | "heuristic"
SKIN_MODE=auto
SKIN_MAHA_THRESHOLD=3.5
SKIN_MIN_SEED_PIXELS=350

# SCHP (Self-Correction Human Parsing) ONNX model
SCHP_MODEL_PATH=models/schp_lip.onnx
SCHP_DATASET=lip
SCHP_EXPAND_SKIN=false
# If >0, expansion only grows within this pixel radius from SCHP skin parts (helps reduce clothing false positives).
SCHP_MAX_EXPAND_PX=45
# Optional ONNX Runtime threading (0 = ORT default)
SCHP_INTRA_THREADS=0
SCHP_INTER_THREADS=0

# MHP (Detectron2) optional config (only used when SKIN_BACKEND=auto/mhp)
MHP_D2_CONFIG=COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x.yaml
MHP_D2_WEIGHTS=
MHP_D2_SCORE_THRESH=0.5
MHP_D2_MAX_PEOPLE=25
MHP_D2_PERSON_CLASS_ID=0
MHP_BBOX_EXPAND_RATIO=1.2
